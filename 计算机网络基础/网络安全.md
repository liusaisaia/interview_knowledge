······
[TOC]
······


# **目录**

## <a href="#tongyuan">一、同源策略</a>
## <a href="#XSS">二、XSS</a>
## <a href="#CSRF">二、CSRF</a>

### [一、同源策略](#tongyuan)


所谓的的源是指URL，可以是连接： https://github.com/liusaisaia

|  名称   | 举例  |
|  ----  | ----  |
|  协议   | http、https |
| 域名  | `github.com` |
| 端口  | 8080、 8081 |

>其中，如果URL上未标明端口，那么http默认就是80端口，https默认443端口

所谓的同源策略就是（同端口、同域名、同源策略）

浏览器默认两个相同的源之间是可以访问资源和操作DOM的。两个不同的源之间若想相互访问资源或者DOM，那么就会有一套记住的安全策略的制约，这就是同源策略。

### 1.1为什么需要同源策略
主要是表现在DOM、Web数据和网络三个层面

* 第一个，DOM层面

&emsp; &emsp;&emsp;同源策略限制了来自不同源的JavaScript脚本对当前DOM对象读写操作。

当你在A页面，通过`<a href="XXX">`的形式打开B页面，经过代码可以将A页面的内容隐藏掉:
```js
let pdom = opener.document;
pdom.body.style.display = 'none';
```
这种情况是同源情况下DOM的一个操作，不同源的情况下是无法操作的

* 第二个，是数据层面


&emsp; &emsp;&emsp; 同源策略限制了不同源的站点读取当前站的Cookie、indexedDB(是一种使用浏览器存储大量数据的方法，它创造的数据可以被查询，并且可以离线使用)、LocalStorage等数据

* 第三个，网络层面
限制了通过XMLHttpRequest等方式将站点的数据发送给不同源的站点

### [二、XSS](#XSS)

### 什么是XSS

XSS(Cross Site Script) 跨站脚本攻击。指的是攻击者想网页注入恶意的客户端代码，通过恶意的脚本对客户端网页进行篡改，从而在用户浏览网页时，对用户浏览器进行控制或者获取用户隐私数据的一种攻击方式。例如：

* 可以窃取Cookie信息，恶意的javaScript可以通过document.cookie获取cookie信息，然后通过XMLHttpRequest或者Fetch加上CORS功能将数据发送给恶意服务器，恶意服务器拿到用户的Cookie信息之后，就可以在其他电脑上模拟用户的登录，然后进行转账等操作。
* 可以监听用户的行为，可以使用addEventLisener接口来监听键盘事件，获取比如信用卡等信息，进行恶意操作

注入恶意脚本分3种方式：

* 存储型： 攻击被存储在服务端，常见的是在评论区插入攻击脚本，如果存到服务端，那么所有的用户都会受到攻击
* 反射性： 攻击者将脚本混在URL里，服务端接收到URL将恶意代码当做参数取出并拼接在HML里返回，浏览器解析此HTML后执行恶意代码，
* DOM型： 攻击者将恶意脚本注入用户的页面中。

### XSS防御

* 输入检查： 对输入内容进行过滤或者转义
* 设置httpOnly： 可以防止JavaScript获取Cookie，只能在HTTP请求过程中使用cookie
* 开启CSP白名单： 可以阻止白名单以外的资源加载和运行

### [二、CSRF](#CSRF)

跨站请求伪造

是一种劫持受信任用户向服务器发送预期请求的攻击方式，它是攻击者借助受害者的Cookie片区服务器的信任，但是它并不能拿到Cookie，也看不到Cookie的内容，它能做的就是给服务器发送请求，然后执行请求中所描述的命令，以此来改变服务器中的数据，也就是并不能窃取到服务器中的数据。
